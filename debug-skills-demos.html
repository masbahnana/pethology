<!DOCTYPE html>
<html>
<head>
  <title>Skills Demos Debug</title>
  <style>
    body { font-family: monospace; padding: 20px; background: #f5f5f5; }
    .log { padding: 8px; margin: 5px 0; border-radius: 4px; }
    .success { background: #d4edda; color: #155724; }
    .error { background: #f8d7da; color: #721c24; }
    .info { background: #d1ecf1; color: #0c5460; }
    pre { background: white; padding: 12px; overflow-x: auto; border: 1px solid #ddd; }
  </style>
</head>
<body>
  <h1>üîç Skills Demos Debug Tool</h1>
  <p>Este tool vai inspecionar a estrutura dos dados do Firebase</p>
  <div id="output"></div>

  <script type="module">
    import { PethologyFirebaseREST } from './assets/js/firebase-rest.js';

    const output = document.getElementById('output');

    function log(message, type = 'info') {
      const div = document.createElement('div');
      div.className = `log ${type}`;
      div.textContent = message;
      output.appendChild(div);
    }

    function logJson(obj) {
      const pre = document.createElement('pre');
      pre.textContent = JSON.stringify(obj, null, 2);
      output.appendChild(pre);
    }

    async function debugSkillsDemos() {
      try {
        log('üîç Fetching /skills_demos collection...', 'info');
        const response = await PethologyFirebaseREST.request('/skills_demos');
        
        if (!response.documents || response.documents.length === 0) {
          log('‚ùå No skills_demos documents found!', 'error');
          log('Response was:', 'info');
          logJson(response);
          return;
        }

        log(`‚úÖ Found ${response.documents.length} skills_demos documents`, 'success');

        response.documents.forEach((doc, idx) => {
          log(`\nüìÑ Document ${idx + 1}:`, 'info');
          const converted = PethologyFirebaseREST.convertDocument(doc);
          logJson(converted);
          
          log(`‚öôÔ∏è Checking fields:`, 'info');
          log(`  - _id: ${converted._id || 'MISSING'}`, converted._id ? 'success' : 'error');
          log(`  - title: ${converted.title || 'MISSING'}`, converted.title ? 'success' : 'error');
          log(`  - status: ${converted.status || 'MISSING'}`, converted.status ? 'success' : 'error');
          log(`  - items array: ${Array.isArray(converted.items) ? converted.items.length + ' items' : 'MISSING'}`, Array.isArray(converted.items) ? 'success' : 'error');
        });

      } catch (error) {
        log(`‚ùå Error: ${error.message}`, 'error');
        log(`Stack: ${error.stack}`, 'error');
      }
    }

    debugSkillsDemos();
  </script>
</body>
</html>
